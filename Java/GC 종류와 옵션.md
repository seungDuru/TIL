---
aliases:
  - "\bGC의"
---
자바 애플리케이션의 성능 최적화에서 중요한 부분 중 하나는 적절한 가비지 컬렉터(GC)를 선택하고 올바른 설정을 적용하는 것이다. 최신 자바 버전(특히 Java 11, 17 및 그 이후)에서는 다양한 GC 알고리즘을 제공하고 있으며, 각 알고리즘은 애플리케이션의 특성에 따라 성능에 큰 영향을 미칠 수 있다.

## 1. 최신 자바에서 사용 가능한 GC 종류
자바의 최신 버전에서는 여러 가지 GC 알고리즘을 제공한다. 각 GC는 서로 다른 특성과 장점을 가지고 있어 애플리케이션의 요구사항에 따라 선택할 수 있다.

### Serial GC
- **특징**: 싱글 스레드 방식으로, 주로 작은 애플리케이션이나 테스트 용도 사용됨
- **적용 옵션**: `-XX:+UseSerialGC`
- **사용 시기**: 메모리 사용량이 적고 단일 스레드로 동작하는 경우 적합

### Parallel GC (또는 Throughput GC)
- **특징**: 다수의 스레드를 사용해 GC 작업을 수행하며, CPU 사용률을 높여 가비지 컬렉션 시간을 줄이는 데 중점을 둠
- **적용 옵션**: `-XX:+UseParallelGC`
- **사용 시기**: 애플리케이션의 응답 속도보다 처리량이 중요한 경우 사용

### G1 GC (Garbage First GC)
- **특징**: 낮은 지연 시간과 고성능을 목표로 설계되었으며, 자바 9부터 기본 GC로 사용되고 있음
- **적용 옵션**: `-XX:+UseG1GC`
- **사용 시기**: 대규모 애플리케이션에서 짧은 GC 지연 시간과 일관된 성능을 원하는 경우 사용하며, G1 GC는 힙을 여러 개의 영역으로 나누어 작업하므로, GC 작업 동안 큰 멈춤을 방지할 수 있음

### ZGC
- **특징**: 초저지연 가비지 컬렉터로, 매우 큰 힙에서도 수 밀리초 단위의 짧은 정지 시간만 발생
- **적용 옵션**: `-XX:+UseZGC`
- **사용 시기**: 힙 메모리가 크고, 멈춤 시간이 아주 짧아야 하는 애플리케이션에 적합

### Shenandoah GC
- **특징**: ZGC와 비슷하게 저지연을 목표로 하는 가비지 컬렉터. 자바 12부터 사용 가능하며, 힙의 대부분을 동시에 수집해 짧은 멈춤 시간을 유지
- **적용 옵션**: `-XX:+UseShenandoahGC`
- **사용 시기**: 저지연이 중요하고, 응답 시간이 중요한 대규모 애플리케이션에서 사용

## 2. 실무에서 많이 사용하는 GC와 그 이유

### G1 GC
G1 GC는 최신 자바에서 가장 많이 사용되는 GC 중 하나이다. 그 이유는 적당한 수준의 Throughput과 Low Latency를 제공하며, 대규모 애플리케이션에서도 안정적인 성능을 보이기 때문이다. 특히 대규모 JVM에서 Full GC의 영향을 최소화하고 안정적인 응답 시간을 유지하는 데 뛰어난 성능을 보여주고있다.

**사용 예시 옵션**:
```sh
-XX:+UseG1GC \
-XX:MaxGCPauseMillis=200 \
-XX:InitiatingHeapOccupancyPercent=45
```
- `-XX:MaxGCPauseMillis`: GC 멈춤 시간의 목표치를 설정하여, G1 GC가 목표 지연 시간 내에 수집을 마치도록 유도
- `-XX:InitiatingHeapOccupancyPercent`: 힙의 몇 퍼센트가 찼을 때 GC를 시작할지 결정하는 수치 (기본값은 45%)

### Parallel GC
Parallel GC는 여전히 많은 레거시 애플리케이션에서 사용되고 있다. 응답 시간보다는 처리량(Throughput)이 중요한 경우, Parallel GC가 적합하다. 예를 들어, 배치 처리나 백엔드 작업에서 GC 지연 시간보다는 많은 양의 데이터를 빠르게 처리하는 것이 중요한 경우에 사용된다.

**사용 예시 옵션**:
```sh
-XX:+UseParallelGC \
-XX:ParallelGCThreads=4
```
- `-XX:ParallelGCThreads`: GC 작업을 수행할 스레드의 수 - 서버의 CPU 코어 수에 맞게 조정하여 Throughput을 최대화할 수 있음

### ZGC
ZGC는 최근 실시간 애플리케이션, 특히 짧은 지연 시간이 중요한 경우에 도입되고 있다. ZGC의 강점은 매우 짧은 멈춤 시간과 큰 힙을 다룰 수 있다는 점이다. 예를 들어, 금융 거래 시스템이나 사용자 인터랙션이 많은 애플리케이션에서 ZGC가 유용할 수 있다.

**실무 사용 예시 옵션**:
```sh
-XX:+UseZGC \
-XX:SoftMaxHeapSize=16g
```
- `-XX:SoftMaxHeapSize`: 소프트 힙 크기를 지정하여 메모리 사용량을 조절할 수 있다. 이는 힙을 효율적으로 사용할 수 있도록 도와준다.

## 3. GC 튜닝 팁
1. **어플리케이션의 특성에 맞는 GC 선택**: 응답 속도가 중요한 경우 G1 GC나 ZGC를 고려하고, 처리량이 중요한 경우 Parallel GC를 고려해야한다.
2. **힙 크기 및 GC 옵션 튜닝**: GC 멈춤 시간을 줄이기 위해 힙 크기와 GC 관련 옵션을 잘 튜닝하는 것이 중요합니다. 예를 들어, `-Xms`와 `-Xmx`를 동일하게 설정하여 힙 리사이징을 방지할 수 있습니다.
3. **프로파일링 도구 사용**: JVisualVM, Java Mission Control(JMC) 등을 사용하여 GC 로그와 힙 사용량을 모니터링하면서 실시간으로 성능을 분석하는 것이 중요합니다.

## 마무리
자바의 다양한 GC는 각기 다른 상황에서 최적의 성능을 제공합니다. 최신 자바에서 제공하는 G1, ZGC, Shenandoah GC 등은 각각의 장점이 있으므로, 애플리케이션의 특성에 맞춰 적절한 GC를 선택하는 것이 중요합니다. 실무에서는 G1 GC가 안정적인 성능을 제공하기 때문에 많이 사용되며, 최신 애플리케이션에서는 ZGC와 같은 저지연 GC도 주목받고 있습니다. GC 옵션을 잘 이해하고 적절하게 튜닝하여 애플리케이션의 성능을 극대화해 보세요.

